name: Deploy to GitHub Pages

on:
  push:
    branches: [main]

jobs:
  deploy:
    runs-on: ubuntu-latest

    steps:
    - name: Checkout repository
      uses: actions/checkout@v3

    - name: Deploy files to main
      run: |
        # –£–∫–∞–∑—ã–≤–∞–µ–º –ø–∞–ø–∫—É –¥–ª—è –¥–µ–ø–ª–æ—è
        FOLDER_TO_DEPLOY="./build/web-mobile"

        # –ü—Ä–æ–≤–µ—Ä—è–µ–º, —Å—É—â–µ—Å—Ç–≤—É–µ—Ç –ª–∏ –ø–∞–ø–∫–∞
        if [ -d "$FOLDER_TO_DEPLOY" ]; then
          echo "‚úÖ Deploying files from $FOLDER_TO_DEPLOY"

          # –ö–æ–ø–∏—Ä—É–µ–º —Ñ–∞–π–ª—ã –≤ –∫–æ—Ä–µ–Ω—å —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏—è
          cp -r $FOLDER_TO_DEPLOY/* .

          # –ù–∞—Å—Ç—Ä–æ–π–∫–∞ git
          git config --global user.name "GitHub Actions"
          git config --global user.email "actions@github.com"

          # –ù–∞—Å—Ç—Ä–∞–∏–≤–∞–µ–º –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—é —á–µ—Ä–µ–∑ GH_PAT
          git remote set-url origin https://x-access-token:${{ secrets.GH_PAT }}@github.com/${{ github.repository }}.git

          # –î–æ–±–∞–≤–ª—è–µ–º –∏–∑–º–µ–Ω–µ–Ω–∏—è –≤ —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–π
          git add .
          git commit -m "üöÄ Deploy to GitHub Pages" || echo "No changes to commit"
          git push origin main
        else
          echo "‚ùå Error: Folder $FOLDER_TO_DEPLOY does not exist!"
          exit 1
        fi
